# 9. 타입 변환과 단축 평가

## 타입 변환

### 타입 변환

- 타입 변환은 자료의 타입을 변환하는 것을 의미한다.
- 명시적 타입 변환과 암묵적 타입 변환이 존재한다.
- 타입 변환은 원시 값을 변경할 수 없다. 원시 값을 이용해 다른 타입의 새 원시값을 생성하는 것이다.
- 명시적 변환은 코드에 의도가 드러나나 암묵적 변환은 코드에 의도가 드러나지 않는다.
- 따라서 의도치 않는 오류를 일으킬 수도 있다.
- 하지만 암묵적 변환이 가독성이 더 뛰어날 수도 있다.
- 오류를 막기 위해선 코드의 예측가능성이 중요하다.

### 암묵적 타입 변환

- 자바스크립트는 동적 타입을 가진다.
- 이로 인해 자바스크립트는 문맥에 따라 개발자의 의도와 상관없이 암묵적으로 타입을 변환한다.

#### 문자열

```javascript
1+'1'='11';
```

위처럼 {다른 타입} + '{문자열}'의 경우 문자열로 변환한다.

또한 리터럴 표현식의 경우,

```javascript
`1+1=${1 + 1}`; // -> '1+1=2'
```

표현식의 연산 결과를 문자열로 변환한다.

#### 숫자

가항(+)를 제외한 다른 산술 연산자는 모두 숫자형으로 변환하려고 한다.

```javascript
1-'1'=0;
```

비교 연산자 또한 숫자로 변환되어 연산된다.

```javascript
"1" > 0; // -> true
```

단항 연산자는 숫자형으로 변환된다.

```javascript
+"" + // -> 0
  "1" + // -> 1
  "a" + // -> NaN
  true + // -> 1
  false + // -> 0
  null + // -> 0
  [] + // -> 0
  {} + // -> NaN
  undefined + // -> NaN
  [1, 2] + // -> NaN
  function () {} + // -> NaN
  Symbol(); // -> 타입에러
```

#### 불리언, 참값과 거짓값

자바스크립트에서 값은 참값과 거짓값으로 구분된다.
거짓값은 다음과 같다.

- false
- undefined
- null
- 0
- NaN
- '' // 빈 문자열

위 값을 제외한 모든 값은 참값이다.

### 명시적 타입 변환

개발자는 생성자 함수를 new 키워드 없이 이용하여 명시적으로 타입을 변환활 수 있다.
또한 암묵적 타입 변환을 이용하여 타입을 변환할 수 있다.

#### 문자열

- new 없는 String 생성자 함수
- Object.prototype.toString 메서드를 호출하는 방법
- 문자열 연결 연산자를 사용하여 암묵적 변환 이용

#### 숫자

- new 없는 Number 생성자 함수
- parseInt, parseFloat 함수를 통한 문자열의 숫자 변환
- \+ 단항 연산자 이용
- \* 산술 연산자 이용

#### 불리언

- new 없는 Boolean 생성자 함수
- ! 부정 연산자를 제곱 \\ !!

## 단축 평가

### 논리연산자와 단축 평가

자바스크립트에서 논리 합(|| //OR)과 논리 곱(&& //AND)은 좌항에서 우항으로 평가가 진행된다.
좌항에서 논리연산의 결과가 정해질 경우 우항은 평가하지 않는다. 이를 단축평가라고 한다.
자바스크립트는 다른언어가 불리언으로 결과를 반환하는 것과 달리 참으로 해석되는 값과 거짓으로 해석되는 값을 이용하여 논리 연산의 결과로 피연산자의 값을 그대로 반환한다.

#### 논리합

논리합의 경우 두 항 중 한 항의 값이 참값일 경우 참의 결과를 가진다.
때문에 자바스크립트는
좌항의 값이 참일 경우 우항의 결과와 관계 없이 좌항을 그대로 반환한다.
반대로 좌항의 결과가 거짓일 경우 우항을 반환한다.

한마디로 첫 항이 참이면 어차피 결과는 참이어야 하기 때문에 둘째항을 평가하지 않는다.

#### 논리곱

논리곱의 경우 두 항의 값이 모두 참값일 경우 참의 결과를 가진다.
때문에 자바스크립트는
좌항의 값이 참일 경우 우항을 그대로 반환한다.
반대로 좌항의 결과가 거짓일 경우 좌항을 반환한다.

한마디로 첫 항이 거짓이면 어차피 결과는 거짓이기 때문에 둘째 항을 평가하지 않는다.

#### 논리연산자 단축 평가 도식

![단축 평가 도식](./논리연산자%20단축평가%20도식.png)

### 옵셔널 체이닝

{피연산자}?.{하위 프로퍼티}의 형태로 사용되며 피연산자의 내용이 null 또는 undefined일 경우 undefined를 반환하고, 아닐경우 하위 프로퍼티를 참조한다.

### null 병합 연산자

{좌항} ?? {우항}의 형태를 가진 null 병합 연산자는 좌항이 null 또는 undefined일 경우 우항의 내용을 반환한다. 이 연산자는 null 값을 대체하여 기본값을 설정하는데 유용하다.
ES11 이전에는 논리 합 연산자를 활용해야 했는데 이 경우엔 거짓으로 해석되는 값 전부가 거짓으로 처리되었다. 이 경우엔, 0 또는 ''와 같은 값이 허용되는 경우에도 거짓으로 처리되어 개발자의 의도를 벗어난 동작이 발생했다.
